import{i as e}from"./index.umd.min-ead3793b.js";import{d as l}from"./browser-f4ca2ed3.js";import"./vue-echarts-bffdbdc9.js";import{a as t,c as r}from"./element-plus-e665fdbc.js";import{a as o}from"./index-ecdd2562.js";import{u as i}from"./index-1fe6d5c5.js";import{v as s}from"./@vue.runtime-dom-532828a1.js";import"./store-acbd10e3.js";import{Y as a}from"./@element-plus.icons-vue-e9c91902.js";import{u as n}from"./component-643e0931.js";import{d,e as p,W as u,_ as m,K as c,o as v,c as f,a as h,I as b,J as j,N as y,b as g,F as k,U as w,M as x,al as _,ak as C,q as z}from"./@vue.runtime-core-6173334e.js";import{r as W,u as T}from"./@vue.reactivity-54707199.js";import{p as I,L as q}from"./@vue.shared-0cc4c744.js";import{_ as F}from"./_plugin-vue_export-helper-1b428a4d.js";import{c as N}from"./lodash-es-fd5b777b.js";import"./axios-bb93cf32.js";import"./vue-21f38777.js";import"./monaco-editor-c28fb00f.js";import"./nprogress-27d9be10.js";import"./vue-router-25454f45.js";import"./@vueuse.core-cb7ad152.js";import"./@vueuse.shared-feb01f08.js";import"./pinia-77f7f468.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-005b47e8.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@popperjs.core-b696b006.js";import"./@ctrl.tinycolor-a951068a.js";import"./dayjs-f8876307.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";const G={class:"dict-group"},K={class:"head"},R=(e=>(_("data-v-221e20f3"),e=e(),C(),e))((()=>h("span",null,"类型",-1))),E={class:"list"},L=["onClick","onContextmenu"],M=d({name:"undefined"}),U=F(d({...M,emits:["refresh"],setup(o,{emit:d}){const{service:_}=i(),{ViewGroup:C}=n(),z=e.useForm(),F=W([]),N=W(!1);async function M(){N.value=!0,await _.dict.type.list({order:"createTime",sort:"asc"}).then((e=>{var l;F.value=e,(null==(l=C.value)?void 0:l.selected)||U()})),N.value=!1}function U(e){var l,t;e||(e=F.value[0]),e&&(d("refresh",{typeId:e.id,page:1}),null==(l=C.value)||l.select(e),null==(t=C.value)||t.setTitle(`字典列表（${e.name}）`))}function V(e){var l;null==(l=z.value)||l.open({title:e?"编辑类型":"添加类型",width:"500px",props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}],form:{...e},on:{submit(l,{close:r,done:o}){_.dict.type[e?"update":"add"](l).then((()=>{t.success("保存成功"),r(),M()})).catch((e=>{t.error(e.message),o()}))}}})}return p((()=>{M()})),(o,i)=>{const n=u("el-button"),d=u("el-icon"),p=u("el-empty"),W=u("el-scrollbar"),J=u("cl-form"),A=m("permission"),B=m("loading");return c((v(),f("div",G,[h("div",K,[R,c((v(),b(n,{type:"success",bg:"",size:"small",onClick:i[0]||(i[0]=e=>V())},{default:j((()=>[y("添加")])),_:1})),[[A,T(_).dict.type.permission.add]])]),h("div",E,[g(W,null,{default:j((()=>[h("ul",null,[(v(!0),f(k,null,w(F.value,((o,i)=>{var n,p,u,m;return v(),f("li",{key:i,class:I(["item",{"is-active":(null==(p=null==(n=T(C))?void 0:n.selected)?void 0:p.id)==o.id}]),onClick:e=>U(o),onContextmenu:i=>{!function(o,i){e.ContextMenu.open(o,{hover:{target:"item"},list:[{label:"编辑",hidden:!l(_.dict.type.permission.update),callback(e){e(),V(i)}},{label:"删除",hidden:!l(_.dict.type.permission.delete),callback(e){e(),r.confirm("是否要删除该类型？","提示",{type:"warning"}).then((()=>{_.dict.type.delete({ids:[i.id]}).then((async()=>{var e,l;t.success("删除成功"),await M(),(null==(l=null==(e=C.value)?void 0:e.selected)?void 0:l.id)==i.id&&U()})).catch((e=>{t.error(e.message)}))})).catch((()=>null))}}]})}(i,o)}},[h("span",null,q(o.name)+" - "+q(o.key),1),c(g(d,null,{default:j((()=>[g(T(a))])),_:2},1536),[[s,(null==(m=null==(u=T(C))?void 0:u.selected)?void 0:m.id)==o.id]])],42,L)})),128)),0==F.value.length?(v(),b(p,{key:0,"image-size":80})):x("",!0)])])),_:1})]),g(J,{ref_key:"Form",ref:z},null,512)])),[[B,N.value]])}}}),[["__scopeId","data-v-221e20f3"]]),V=d({name:"dict-list"}),J=d({...V,setup(l){const{service:t}=i(),{ViewGroup:r}=n(),s=e.useUpsert({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:"上级节点",prop:"parentId",component:{name:"el-tree-select",props:{data:z((()=>{var e;const l=N(null==(e=a.value)?void 0:e.data);return function e(l,t){var r;l.id&&l.id==(null==(r=s.value)?void 0:r.getForm("id"))&&(t=!0),t&&(l.disabled=!0),l.children&&l.children.forEach((l=>{e(l,t)}))}({children:l},!1),l})),props:{label:"name",value:"id",children:"children",disabled:"disabled"},clearable:!0,filterable:!0,"default-expand-all":!0,"check-strictly":!0}}},{label:"名称",prop:"name",required:!0,component:{name:"el-input"}},{label:"值",prop:"value",component:{name:"el-input"}},{label:"排序",prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(e,{next:l}){var t,o;l({...e,typeId:null==(o=null==(t=r.value)?void 0:t.selected)?void 0:o.id})}}),a=e.useTable({contextMenu:["refresh",e=>{var l;return{label:"新增",hidden:!(null==(l=t.dict.info._permission)?void 0:l.add),callback(l){h(e),l()}}},"edit","delete","order-asc","order-desc"],columns:[{label:"名称",prop:"name",align:"left",minWidth:200},{label:"数值",prop:"value",align:"left",minWidth:200},{label:"排序",prop:"orderNum",sortable:"desc",width:100},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"创建时间",prop:"createTime",sortable:"custom",minWidth:160},{label:"更新时间",prop:"updateTime",sortable:"custom",minWidth:160},{type:"op",width:250,buttons:["slot-btn","edit","delete"]}]}),d=e.useCrud({service:t.dict.info,onRefresh(e,{render:l}){t.dict.info.list({...e,page:void 0,size:void 0}).then((e=>{l(o(e))}))}});function p(e){var l;null==(l=d.value)||l.refresh(e)}function f(e,l){var t;(null==l?void 0:l.property)&&e.children&&(null==(t=a.value)||t.toggleRowExpansion(e))}function h(e){var l;null==(l=d.value)||l.rowAppend({parentId:e.id,orderNum:1})}return(e,l)=>{const o=u("cl-refresh-btn"),i=u("cl-add-btn"),n=u("cl-flex1"),k=u("cl-search-key"),w=u("cl-row"),x=u("el-button"),_=u("cl-table"),C=u("cl-upsert"),z=u("cl-crud"),W=u("cl-view-group"),I=m("permission");return v(),b(W,{ref_key:"ViewGroup",ref:r},{left:j((()=>[g(U,{onRefresh:p})])),right:j((()=>[g(z,{ref_key:"Crud",ref:d},{default:j((()=>[g(w,null,{default:j((()=>{var e;return[g(o),g(i,{disabled:!(null==(e=T(r))?void 0:e.selected)},null,8,["disabled"]),g(n),g(k)]})),_:1}),g(w,null,{default:j((()=>[g(_,{ref_key:"Table",ref:a,"row-key":"id",onRowClick:f},{"slot-btn":j((({scope:e})=>[c((v(),b(x,{text:"",bg:"",type:"success",onClick:l=>h(e.row)},{default:j((()=>[y("新增")])),_:2},1032,["onClick"])),[[I,T(t).dict.info.permission.add]])])),_:1},512)])),_:1}),g(w,null,{default:j((()=>[g(n)])),_:1}),g(C,{ref_key:"Upsert",ref:s},null,512)])),_:1},512)])),_:1},512)}}});export{J as default};
