import{i as e}from"./index.umd.min-ead3793b.js";import{d as l,u as a,e as o,f as r}from"./browser-f4ca2ed3.js";import"./vue-echarts-bffdbdc9.js";import{c as n,a as t,e as p,b as u}from"./element-plus-e665fdbc.js";import"./store-acbd10e3.js";import"./index-ecdd2562.js";import{u as d}from"./index-1fe6d5c5.js";import{v as i,w as s}from"./@vue.runtime-dom-532828a1.js";import{V as c,W as m,E as v,X as f}from"./@element-plus.icons-vue-e9c91902.js";import{u as b}from"./component-643e0931.js";import{l as y}from"./lodash-9a766e44.js";import{r as h}from"./lodash-es-fd5b777b.js";import{d as g,e as w,W as I,_ as k,o as _,c as Y,a as D,b as x,J as j,M as C,K as T,N as M,I as N,al as V,ak as F,p as O,U,F as q}from"./@vue.runtime-core-6173334e.js";import{r as $,u as z,h as E}from"./@vue.reactivity-54707199.js";import{p as L,L as R}from"./@vue.shared-0cc4c744.js";import{_ as S}from"./_plugin-vue_export-helper-1b428a4d.js";import{d as W}from"./dayjs-f8876307.js";import"./axios-bb93cf32.js";import"./vue-21f38777.js";import"./monaco-editor-c28fb00f.js";import"./nprogress-27d9be10.js";import"./vue-router-25454f45.js";import"./@vueuse.core-cb7ad152.js";import"./@vueuse.shared-feb01f08.js";import"./pinia-77f7f468.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-005b47e8.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@popperjs.core-b696b006.js";import"./@ctrl.tinycolor-a951068a.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";const A={class:"dept-tree"},B={class:"dept-tree__header"},G=(e=>(V("data-v-22d67235"),e=e(),F(),e))((()=>D("div",null,"订单类型",-1))),P={class:"dept-tree__op"},K={class:"no"},J=["onContextmenu"],Q={class:"dept-tree__node"},H=["onClick"],X=["onClick"],Z=g({name:"dept-tree"}),ee=S(g({...Z,props:{drag:{type:Boolean,default:!0},level:{type:Number,default:99},orderInfo:Object},emits:["refresh"],setup(a,{emit:o}){const r=a,{service:p,browser:u}=d(),{ViewGroup:f}=b(),g=e.useForm(),V=$([{name:"全部",value:"all"}]),F=$(!1),O=$(!1);function U({data:e}){return e.parentId}function q(e,l){return l.data.parentId}const E=async()=>{F.value=!0,O.value=!1,await p.dict.info.data({types:["subOrderType"]}).then((e=>{var l;V.value.push(...e.subOrderType),(null==(l=f.value)?void 0:l.selected)||S()})),F.value=!1};function S(e){var l,a,n,t,p,u;if(e){if(e){o("refresh",{page:1,orderType:e.value}),null==(t=f.value)||t.select(e);let l=y.isEmpty(r.orderInfo)?e.name:`${null==(p=r.orderInfo)?void 0:p.projectNum} -  ${e.name}`;null==(u=f.value)||u.setTitle(`子订单列表（${l})`)}}else{o("refresh",{page:1}),null==(l=f.value)||l.select(e);var d=y.isEmpty(r.orderInfo)?"全部":`${null==(a=r.orderInfo)?void 0:a.projectNum} - 全部`;null==(n=f.value)||n.setTitle(`子订单列表 (${d})`)}}function W(e){var l;const a=e.id?"update":"add";null==(l=g.value)||l.open({title:"编辑部门",width:"550px",props:{labelWidth:"100px"},items:[{label:"部门名称",prop:"name",component:{name:"el-input"},required:!0},{label:"上级部门",prop:"parentName",component:{name:"el-input",props:{disabled:!0}}},{label:"排序",prop:"orderNum",component:{name:"el-input-number",props:{"controls-position":"right",min:0,max:100}}}],form:{...e},on:{submit(l,{done:o,close:r}){p.base.sys.department[a]({id:e.id,parentId:e.parentId,name:l.name,orderNum:l.orderNum}).then((()=>{t.success(`新增部门 “${l.name}” 成功`),r(),E()})).catch((e=>{t.error(e.message),o()}))}}})}function Z(e){e?n.confirm("部门架构已发生改变，是否保存？","提示",{type:"warning"}).then((async()=>{const e=[];!function l(a,o){a.forEach((a=>{a.parentId=o,e.push(a),a.children&&h(a.children)&&l(a.children,a.id)}))}(V.value,null),await p.base.sys.department.order(e.map(((e,l)=>({id:e.id,parentId:e.parentId,orderNum:l})))).then((()=>{t.success("更新排序成功")})).catch((e=>{t.error(e.message)})),E(),O.value=!1})).catch((()=>null)):E()}function ee(a,o,u){o||(o=V.value[0]||{});const d=p.base.sys.department.permission;e.ContextMenu.open(a,{list:[{label:"新增",hidden:u&&u.level>=r.level||!l(d.add),callback(e){W({name:"",parentName:o.name,parentId:o.id}),e()}},{label:"编辑",hidden:!l(d.update),callback(e){W(o),e()}},{label:"删除",hidden:!o.parentId||!l(d.delete),callback(e){!function(e){async function l(l){await p.base.sys.department.delete({ids:[e.id],deleteUser:l}).then((()=>{var a,o;(null==(o=null==(a=f.value)?void 0:a.selected)?void 0:o.id)==e.id&&S(),l?t.success("删除成功"):n.confirm(`“${e.name}” 部门的用户已成功转移到 “${e.parentName}” 部门。`,"删除成功")})),E()}n.confirm(`该操作会删除 “${e.name}” 部门的所有用户，是否确认？`,"提示",{type:"warning",confirmButtonText:"直接删除",cancelButtonText:"保留用户",distinguishCancelAndClose:!0}).then((()=>{l(!0)})).catch((e=>{"cancel"==e&&l(!1)}))}(o),e()}}]})}return w((function(){E()})),(e,l)=>{const o=I("el-icon"),r=I("el-tooltip"),n=I("el-button"),t=I("el-tree"),p=I("el-scrollbar"),d=I("cl-form"),b=k("loading");return _(),Y("div",A,[D("div",B,[G,D("ul",P,[D("li",{onClick:l[0]||(l[0]=e=>E())},[x(r,{content:"刷新"},{default:j((()=>[x(o,null,{default:j((()=>[x(z(c))])),_:1})])),_:1})]),a.drag&&!z(u).isMini?(_(),Y("li",{key:0,onClick:l[1]||(l[1]=e=>O.value=!0)},[x(r,{content:"拖动排序"},{default:j((()=>[x(o,null,{default:j((()=>[x(z(m))])),_:1})])),_:1})])):C("",!0),T(D("li",K,[x(n,{onClick:l[2]||(l[2]=e=>Z(!0)),size:"small"},{default:j((()=>[M("保存")])),_:1}),x(n,{onClick:l[3]||(l[3]=e=>Z(!1)),size:"small"},{default:j((()=>[M("取消")])),_:1})],512),[[i,O.value]])])]),D("div",{class:"dept-tree__container",onContextmenu:s(ee,["stop","prevent"])},[x(p,null,{default:j((()=>[T((_(),N(t,{"node-key":"id","default-expand-all":"",data:V.value,props:{label:"name"},draggable:O.value,"allow-drag":U,"allow-drop":q,"expand-on-click-node":!1,onNodeContextmenu:ee},{default:j((({node:e,data:l})=>{var a,r;return[D("div",Q,[D("span",{class:L(["dept-tree__node-label",{"is-active":l.id==(null==(r=null==(a=z(f))?void 0:a.selected)?void 0:r.id)}]),onClick:e=>S(l)},R(e.label),11,H),z(u).isMini?(_(),Y("span",{key:0,class:"dept-tree__node-icon",onClick:a=>ee(a,l,e)},[x(o,null,{default:j((()=>[x(z(v))])),_:1})],8,X)):C("",!0)])]})),_:1},8,["data","draggable"])),[[b,F.value]])])),_:1})],40,J),x(d,{ref_key:"Form",ref:g},null,512)])}}}),[["__scopeId","data-v-22d67235"]]),le={style:{padding:"20px 100px"}},ae=D("h3",null,"订单明细：",-1),oe=D("br",null,null,-1),re={key:0},ne={style:{color:"crimson"}},te=g({name:"sub-order"}),pe=g({...te,props:{orderInfo:Object},setup(l,{expose:r}){const n=l,{service:t}=d(),{user:p}=a(),{dict:u}=o(),i=$(1!=p.info.id),s=$(),c=$();O((()=>{var e;return null==(e=n.orderInfo)?void 0:e.id}),(async e=>{g({id:e})}),{deep:!0});const m=e.useUpsert({items:[{label:"会员",prop:"uid",span:12,required:!0,hidden:()=>1!=p.info.id,component:{name:"el-select",props:{}}},{label:"订单类型",prop:"orderType",required:!0,span:12,component:{name:"el-select",options:u.get("subOrderType"),props:{onChange:e=>{var l,a,o;h.value=e,"subRenewal"==e?null==(a=m.value)||a.setForm("endDate",W(null==(l=n.orderInfo)?void 0:l.endDate).add(1,"year").format("YYYY-MM-DD")):null==(o=m.value)||o.setForm("endDate",W().add(1,"year").format("YYYY-MM-DD"))}}}},{label:"域名",prop:"domain",hidden:({scope:e})=>"subDomain"!=e.orderType,component:{name:"el-input",disabled:()=>{var e;return"update"!==(null==(e=m.value)?void 0:e.mode)}}},{label:"域名归属我司",prop:"isSelf",span:12,hidden:({scope:e})=>"subDomain"!=e.orderType,value:1,component:{name:"el-switch",props:{activeValue:1,inactiveValue:0}},group:"other"},{label:"是否备案",prop:"isIcp",span:12,hidden:({scope:e})=>"subDomain"!=e.orderType,value:0,component:{name:"el-switch",props:{activeValue:1,inactiveValue:0}},group:"other"},{label:"注册时间",prop:"startDate",span:12,hidden:({scope:e})=>"subDomain"!==e.orderType,value:W().format("YYYY-MM-DD"),component:{name:"el-date-picker",props:{type:"date",valueFormat:"YYYY-MM-DD"}},group:"base"},{label:"到期时间",prop:"endDate",required:!0,span:12,hidden:({scope:e})=>"subExtend"==e.orderType||"subRecord"==e.orderType,component:{name:"el-date-picker",props:{type:"date",valueFormat:"YYYY-MM-DD"}}},{label:"价格",prop:"price",required:!0,span:12,component:{name:"el-input",props:{suffixIcon:f}}},{label:"返佣",prop:"rebate",span:12,value:0,component:{name:"el-input",props:{suffixIcon:f}}},{label:"空间信息",prop:"vpsInfo",hidden:({scope:e})=>"subVps"!==e.orderType,component:{name:"el-input",props:{type:"textarea",rows:4}}},{label:"实名资料",prop:"realNameDataFiles",hidden:({scope:e})=>"subDomain"!==e.orderType,component:{name:"cl-upload",props:{type:"file",multiple:!0,showFileList:!0,draggable:!0,rename:!1}}},{label:"其他资料",prop:"requirementFiles",hidden:({scope:e})=>"subRecord"!==e.orderType&&"subExtend"!==e.orderType,component:{name:"cl-upload",props:{type:"file",multiple:!0,showFileList:!0,draggable:!0,rename:!1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}},()=>({label:"项目进度",prop:"state",span:12,hidden:({scope:e})=>{var l;return"add"==(null==(l=m.value)?void 0:l.mode)||"subExtend"!==e.orderType},component:{name:"el-select",options:y}})],async onOpen(e){var l,a,o,r,u,d,i,s,c,v,f,b,y;if(1==p.info.id){const e=await t.base.sys.user.list();null==(l=m.value)||l.setOptions("uid",e.map((e=>({label:e.nickName||"",value:e.id||""})))),"add"==(null==(a=m.value)?void 0:a.mode)&&(null==(o=m.value)||o.setForm("uid",p.info.id))}"add"==(null==(r=m.value)?void 0:r.mode)&&(null==(d=m.value)||d.setTitle(`${null==(u=n.orderInfo)?void 0:u.projectNum}-新增子订单`),h.value&&(null==(i=m.value)||i.setForm("orderType",h.value))),"update"==(null==(s=m.value)?void 0:s.mode)&&(null==(v=m.value)||v.setTitle(`${null==(c=n.orderInfo)?void 0:c.projectNum}-编辑子订单`)),"subRenewal"==h.value&&(null==(b=m.value)||b.setForm("endDate",W(null==(f=n.orderInfo)?void 0:f.endDate).add(1,"year").format("YYYY-MM-DD"))),"subDomain"!=h.value&&"subVps"!=h.value||null==(y=m.value)||y.setForm("endDate",W().add(1,"year").format("YYYY-MM-DD"))},onSubmit(e,{next:l}){var a,o,r;let t={parentId:null==(a=n.orderInfo)?void 0:a.id,customerId:null==(o=n.orderInfo)?void 0:o.customerId,domain:V.value?V.value:e.domain};1!=(null==(r=p.info)?void 0:r.id)&&(t.uid=p.info.id),(null==e?void 0:e.domain)&&(e.domain=null==e?void 0:e.domain.trim()),l({...e,...t})}}),v=e.useTable({columns:[{type:"selection"},()=>({label:"#",type:"expand",prop:"detail"}),{label:"会员",prop:"userName",hidden:i},{label:"订单类型",prop:"orderType",dict:{text:!0,separator:"",options:u.get("subOrderType").value}},{label:"项目订单",prop:"orderCode",width:300},{label:"价格",prop:"price"},{label:"到期时间",prop:"createTime",component:{name:"cl-date-text",props:{format:"YYYY-MM-DD"}}},{type:"op",buttons:["edit","delete"],width:160}]}),b=e.useCrud({service:t.crm.order,async onRefresh(e,{render:l}){const{list:a,pagination:o}=await t.crm.order.page(e);l(a,o)}}),y=E([{label:"待处理",type:"danger",value:0},{label:"处理中",type:"warning",value:1},{label:"已完成",type:"success",value:2}]),h=$(),g=async e=>{var l,a;e.id=null==(l=n.orderInfo)?void 0:l.id,h.value=e.orderType,e.sub=!0,null==(a=b.value)||a.refresh(e)},k=$(),T=$(),V=$(),F=e.useAdvSearch({items:[()=>({label:"下单者",prop:"uid",hidden:()=>{var e;return 1!=(null==(e=p.info)?void 0:e.id)},component:{name:"cl-select",props:{clearable:!0,options:[...s.value]}}}),()=>({label:"排序",prop:"orderBy",component:{name:"cl-select",props:{clearable:!0,options:[{label:"最近更新",value:"updateTimeDesc"}]}}}),{label:"项目进度",prop:"state",component:{name:"el-select",props:{clearable:!0},options:y}},{label:"到期区间",prop:"month",component:{name:"cl-select",props:{options:[{label:"当月",value:"0"},{label:"未来一个月",value:"1"},{label:"未来二个月",value:"2"},{label:"未来三个月",value:"3"},{label:"未来半年",value:"6"},{label:"未来一年",value:"12"}]}}},{label:"时间",prop:"dateTime",component:{name:"el-date-picker",props:{type:"daterange",startPlaceholder:"开始日期",endPlaceholder:"结束日期",value:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD"}}}]});return w((async()=>{c.value=await t.base.sys.user.list(),s.value=c.value.map((e=>({label:e.nickName||"",value:e.id||""})))})),r({refresh:g}),(e,l)=>{const a=I("cl-refresh-btn"),o=I("cl-add-btn"),r=I("cl-multi-delete-btn"),n=I("cl-flex1"),t=I("cl-adv-btn"),p=I("cl-search-key"),u=I("cl-row"),d=I("cl-date-text"),i=I("cl-table"),s=I("cl-pagination"),c=I("el-input"),f=I("cl-col"),h=I("el-button"),g=I("cl-upsert"),w=I("cl-adv-search"),O=I("cl-crud");return _(),N(O,{ref_key:"Crud",ref:b},{default:j((()=>[x(u,null,{default:j((()=>[x(a),x(o),x(r),x(n),x(t),x(p)])),_:1}),x(u,null,{default:j((()=>[x(i,{ref_key:"Table",ref:v,border:!1},{"column-detail":j((({scope:e})=>{var l,a;return[D("div",le,[ae,oe,"subRenewal"==(null==(l=e.row)?void 0:l.orderType)?(_(),Y("p",re,[M(" 到期时间： "),x(d,{modelValue:e.row.endDate,"onUpdate:modelValue":l=>e.row.endDate=l,format:"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])])):C("",!0),D("p",null,"备注: "+R(null==(a=e.row)?void 0:a.remark),1)])]})),"column-orderCode":j((({scope:e})=>{return[M(R(e.row.orderCode)+" ",1),D("span",ne,R("subExtend"==e.row.orderType?":"+(l=e.row.state,null==(a=y.find((e=>e.value===l)))?void 0:a.label):""),1)];var l,a})),_:1},512)])),_:1}),x(u,null,{default:j((()=>[x(n),x(s)])),_:1}),x(g,{ref_key:"Upsert",ref:m},{"slot-newDomain":j((({scope:e})=>[x(u,null,{default:j((()=>[x(f,{span:18},{default:j((()=>[x(c,{modelValue:T.value,"onUpdate:modelValue":l[0]||(l[0]=e=>T.value=e),placeholder:"不要添加http或https"},null,8,["modelValue"])])),_:1}),x(f,null,{default:j((()=>[x(h,{onClick:l=>(e=>{var l;let a="";a=T.value,""!=e&&(a=T.value+"\n"+e),V.value=a.trim().replace(/^https?:\/\//,"").replace(/\/$/,""),null==(l=m.value)||l.setForm("domain",V.value),T.value="",V.value=""})(e.domain)},{default:j((()=>[M("添加")])),_:2},1032,["onClick"])])),_:2},1024),x(f,null,{default:j((()=>[x(h,{onClick:l=>{return e.domain,null==(a=m.value)||a.setForm("domain",k.value),void(V.value=k.value);var a}},{default:j((()=>[M("重置")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:1},512),x(w,{ref_key:"AdvSearch",ref:F},null,512)])),_:1},512)}}}),ue=g({name:"order-sub"}),de=g({...ue,props:{orderInfo:Object},setup(e){const{ViewGroup:l}=b(),a=$(),o=e=>{var l;null==(l=a.value)||l.refresh(e)};return(r,n)=>{const t=I("cl-view-group");return _(),N(t,{ref_key:"ViewGroup",ref:l,leftWidth:"10%"},{left:j((()=>[x(ee,{onRefresh:o,orderInfo:e.orderInfo},null,8,["orderInfo"])])),right:j((()=>[x(pe,{ref_key:"subOrder",ref:a,orderInfo:e.orderInfo},null,8,["orderInfo"])])),_:1},512)}}}),ie=e=>e&&e.replace(/<[^>]+>/gi,"").replace("\n\r",""),se=(e,l)=>(l||(l=100),e?e.length<=l?e:e.slice(0,l)+"...":""),ce=e=>new Date(e).getTime(),me=(e,l)=>ce(e)>ce(l),ve=g({name:"order-finance"}),fe=g({...ve,props:{orderInfo:Object},setup(l){var r;const n=l,{dict:t}=o(),{user:p}=a(),u=$(1!=(null==(r=p.info)?void 0:r.id)),i=$({});O((()=>n.orderInfo),(e=>{b({projectNum:e.projectNum})}),{deep:!0}),w((()=>{b()}));const{service:s}=d(),c=e.useUpsert({items:[{label:"会员",prop:"uid",span:12,required:!0,hidden:()=>1!=p.info.id,component:{name:"el-select",props:{}}},{label:"项目订单",prop:"orderCode",component:{name:"el-select",options:[]}},{label:"收款",prop:"receiveMoney",span:12,component:{name:"el-input",props:{suffixIcon:f}}},{label:"结算方式",prop:"paytype",span:12,component:{name:"el-select",options:t.get("paytype")}},{label:"结算日期",prop:"payDate",span:12,value:W().format("YYYY-MM-DD"),component:{name:"el-date-picker",props:{type:"date",valueFormat:"YYYY-MM-DD"}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],async onOpen(){var e,l,a,o,r,t,u,d,m,v,f;if(1==p.info.id){const o=await s.base.sys.user.list();null==(e=c.value)||e.setOptions("uid",o.map((e=>({label:e.nickName||"",value:e.id||""})))),"add"==(null==(l=c.value)?void 0:l.mode)&&(null==(a=c.value)||a.setForm("uid",p.info.id))}const b=await s.crm.order.list({projectNum:null==(o=n.orderInfo)?void 0:o.projectNum});null==(r=c.value)||r.setOptions("orderCode",b.map((e=>{i.value[e.orderCode]=e;const l=y(e.orderType);return{label:(null==l?void 0:l.label)+"-"+e.orderCode+"-"+se(ie(e.remark),10),value:e.orderCode}}))),"add"==(null==(t=c.value)?void 0:t.mode)&&(null==(d=c.value)||d.setTitle(`${null==(u=n.orderInfo)?void 0:u.projectNum}-新增订单`)),"update"==(null==(m=c.value)?void 0:m.mode)&&(null==(f=c.value)||f.setTitle(`${null==(v=n.orderInfo)?void 0:v.projectNum}-编辑订单`))},onSubmit(e,{next:l}){var a,o,r,t;let u={orderId:null==(a=i.value[e.orderCode])?void 0:a.id,orderType:null==(o=i.value[e.orderCode])?void 0:o.orderType,projectNum:null==(r=n.orderInfo)?void 0:r.projectNum,incomeAndOut:e.receiveMoney};1!=(null==(t=p.info)?void 0:t.id)&&(u.uid=p.info.id),l({...e,...u})}}),m=e.useTable({columns:[{type:"selection"},{label:"会员",prop:"userName",hidden:u},{label:"项目订单",prop:"orderCode"},{label:"收款",prop:"receiveMoney"},{label:"收款方式",prop:"paytype",dict:{text:!0,separator:"",options:t.get("paytype").value}},{label:"收款日期",prop:"payDate",component:{name:"cl-date-text",props:{format:"YYYY-MM-DD"}}},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{type:"op",buttons:["edit","delete"]}]}),v=e.useCrud({service:s.crm.finance}),b=e=>{var l,a;const o={projectNum:(null==(l=n.orderInfo)?void 0:l.projectNum)|e};null==(a=v.value)||a.refresh(o)},y=e=>{const l=t.get("orderType").value.filter((l=>l.value==e));if(l.length>0)return l[0];const a=t.get("subOrderType").value.filter((l=>l.value==e));return a.length>0?a[0]:{}};return(e,l)=>{const a=I("cl-refresh-btn"),o=I("cl-add-btn"),r=I("cl-multi-delete-btn"),n=I("cl-flex1"),t=I("cl-search-key"),p=I("cl-row"),u=I("cl-table"),d=I("cl-pagination"),i=I("cl-upsert"),s=I("cl-crud");return _(),N(s,{ref_key:"Crud",ref:v},{default:j((()=>[x(p,null,{default:j((()=>[x(a),x(o),x(r),x(n),x(t)])),_:1}),x(p,null,{default:j((()=>[x(u,{ref_key:"Table",ref:m,border:!1},null,512)])),_:1}),x(p,null,{default:j((()=>[x(n),x(d)])),_:1}),x(i,{ref_key:"Upsert",ref:c},null,512)])),_:1},512)}}}),be={style:{width:"100%",height:"100%"}},ye=g({name:"history-reply"}),he=g({...ye,props:{orderInfo:Object,historyInfo:Object},setup(l){var o;const r=l,{service:n}=d(),{user:t}=a(),p=$(1!=(null==(o=t.info)?void 0:o.id)),u=e.useUpsert({items:[{label:"会员",prop:"uid",required:!0,hidden:()=>1!=t.info.id,component:{name:"el-select",props:{}}},{label:"标题",prop:"title",required:!0,component:{name:"el-input"}},{label:"图片上传",prop:"imgs",component:{name:"cl-upload",props:{type:"image",multiple:!0,showFileList:!0,draggable:!0,rename:!1}}},{label:"文件上传",prop:"files",component:{name:"cl-upload",props:{type:"file",multiple:!0,showFileList:!0,draggable:!0,rename:!1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],async onOpen(){var e,l,a;if(1==t.info.id){const o=await n.base.sys.user.list();null==(e=u.value)||e.setOptions("uid",o.map((e=>({label:e.nickName||"",value:e.id||""})))),"add"==(null==(l=u.value)?void 0:l.mode)&&(null==(a=u.value)||a.setForm("uid",t.info.id))}},onSubmit(e,{next:l}){var a,o,n,p,u;let d={orderId:null==(a=r.orderInfo)?void 0:a.id,projectNum:null==(o=r.orderInfo)?void 0:o.projectNum,orderCode:null==(n=r.orderInfo)?void 0:n.orderCode,historyId:null==(p=r.historyInfo)?void 0:p.id};1!=(null==(u=t.info)?void 0:u.id)&&(d.uid=t.info.id),l({...e,...d})}}),i=e.useTable({columns:[{type:"selection"},{label:"会员",prop:"userName",hidden:p},{label:"标题",prop:"title"},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"创建时间",prop:"createTime",component:{name:"cl-date-text",props:{format:"YYYY-MM-DD"}}},{type:"op",buttons:["edit","delete"]}]}),s=e.useCrud({service:n.crm.reply,async onRefresh(e,{render:l}){var a;e.historyId=null==(a=r.historyInfo)?void 0:a.id;const{list:o,pagination:t}=await n.crm.reply.page(e);l(o,t)}});return w((async()=>{var e;null==(e=s.value)||e.refresh()})),(e,l)=>{const a=I("cl-refresh-btn"),o=I("cl-add-btn"),r=I("cl-multi-delete-btn"),n=I("cl-flex1"),t=I("cl-search-key"),p=I("cl-row"),d=I("cl-table"),c=I("cl-pagination"),m=I("cl-upsert"),v=I("cl-crud");return _(),N(v,{ref_key:"Crud",ref:s},{default:j((()=>[x(p,null,{default:j((()=>[x(a),x(o),x(r),x(n),x(t)])),_:1}),x(p,null,{default:j((()=>[D("div",be,[x(d,{ref_key:"Table",ref:i},null,512)])])),_:1}),x(p,null,{default:j((()=>[x(n),x(c)])),_:1}),x(m,{ref_key:"Upsert",ref:u},null,512)])),_:1},512)}}}),ge=g({name:"order-doHistory"}),we=g({...ge,props:{orderInfo:Object},setup(l){var r;const n=l;O((()=>n.orderInfo),(e=>{var l;null==(l=v.value)||l.refresh({orderId:e.id})}),{deep:!0});const{service:t}=d(),{user:u}=a(),{dict:i}=o(),s=$(1==(null==(r=u.info)?void 0:r.id)),c=e.useUpsert({items:[()=>({label:"会员",prop:"uid",span:12,required:!0,hidden:()=>1!=u.info.id,component:{name:"el-select",props:{}}}),()=>{var e;return{label:"标题",prop:"title",required:!0,component:{name:"el-input",props:{disabled:!s.value&&"update"==(null==(e=c.value)?void 0:e.mode)}}}},()=>{var e;return{label:"项目订单",span:12,prop:"orderCode",component:{name:"el-select",options:[],props:{disabled:!s.value&&"update"==(null==(e=c.value)?void 0:e.mode)}}}},()=>{var e;return{label:"跟踪状态",prop:"state",span:12,hidden:()=>{var e;return"add"==(null==(e=c.value)?void 0:e.mode)},component:{name:"el-select",options:b,props:{disabled:!s.value&&"update"==(null==(e=c.value)?void 0:e.mode)}}}},()=>{var e;return{label:"图片上传",prop:"imgs",component:{name:"cl-upload",props:{disabled:!s.value&&"update"==(null==(e=c.value)?void 0:e.mode),type:"image",multiple:!0,showFileList:!0,draggable:!0,rename:!1}}}},()=>{var e;return{label:"文件上传",prop:"files",component:{name:"cl-upload",props:{disabled:!s.value&&"update"==(null==(e=c.value)?void 0:e.mode),type:"file",multiple:!0,showFileList:!0,draggable:!0,rename:!1}}}},()=>{var e;return{label:"备注",prop:"remark",component:{name:"el-input",props:{disabled:!s.value&&"update"==(null==(e=c.value)?void 0:e.mode),type:"textarea",rows:4}}}}],async onOpen(e){var l,a,o,r,p,d,i,s,m,v,b;if(1==u.info.id){const e=await t.base.sys.user.list();null==(l=c.value)||l.setOptions("uid",e.map((e=>({label:e.nickName||"",value:e.id||""})))),"add"==(null==(a=c.value)?void 0:a.mode)&&(null==(o=c.value)||o.setForm("uid",u.info.id))}const y=await t.crm.order.list({projectNum:null==(r=n.orderInfo)?void 0:r.projectNum});null==(p=c.value)||p.setOptions("orderCode",y.map((e=>{const l=f(e.orderType);return{label:(null==l?void 0:l.label)+"-"+e.orderCode+"-"+se(ie(e.remark),10),value:e.orderCode}}))),"add"==(null==(d=c.value)?void 0:d.mode)&&(null==(s=c.value)||s.setTitle(`${null==(i=n.orderInfo)?void 0:i.projectNum}-新增订单`)),"update"==(null==(m=c.value)?void 0:m.mode)&&(null==(b=c.value)||b.setTitle(`${null==(v=n.orderInfo)?void 0:v.projectNum}-编辑订单`))},onSubmit(e,{next:l}){var a,o,r;let t={orderId:null==(a=n.orderInfo)?void 0:a.id,projectNum:null==(o=n.orderInfo)?void 0:o.projectNum};1!=(null==(r=u.info)?void 0:r.id)&&(t.uid=u.info.id),l({...e,...t})}}),m=e.useTable({columns:[{type:"selection"},{label:"会员",prop:"userName"},{label:"标题",prop:"title",showOverflowTooltip:!0},{label:"项目订单",prop:"orderCode"},{label:"跟踪状态",prop:"state"},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"创建时间",prop:"createTime",component:{name:"cl-date-text",props:{format:"YYYY-MM-DD"}}},{type:"op",buttons:["edit","slot-reply"]}]}),v=e.useCrud({service:t.crm.dohistory,async onRefresh(e,{render:l}){var a;e.orderId=null==(a=n.orderInfo)?void 0:a.id;const{list:o,pagination:r}=await t.crm.dohistory.page(e);l(o,r)}},(e=>{e.refresh()})),f=e=>{const l=i.get("orderType").value.filter((l=>l.value==e));if(l.length>0)return l[0];const a=i.get("subOrderType").value.filter((l=>l.value==e));return a.length>0?a[0]:{}},b=E([{label:"待处理",type:"danger",value:0},{label:"处理中",type:"warning",value:1},{label:"已完成",type:"success",value:2}]),y=e=>b.filter((l=>l.value==e))[0],h=$(0),g=$(),w=$(!1);return(e,a)=>{const o=I("cl-refresh-btn"),r=I("cl-add-btn"),n=I("cl-multi-delete-btn"),u=I("cl-flex1"),d=I("cl-search-key"),i=I("cl-row"),s=I("el-button"),f=I("el-popconfirm"),b=I("cl-table"),k=I("cl-pagination"),Y=I("cl-upsert"),D=I("el-dialog"),C=I("cl-crud");return _(),N(C,{ref_key:"Crud",ref:v},{default:j((()=>[x(i,null,{default:j((()=>[x(o),x(r),x(n),x(u),x(d)])),_:1}),x(i,null,{default:j((()=>[x(b,{ref_key:"Table",ref:m,border:!1},{"column-state":j((({scope:e})=>[x(f,{title:"跟踪状态更新?",onConfirm:l=>(e=>{if(2==e.state)return p({title:"提醒",message:"不可再更新",type:"warning"});e.state<2&&e.state++,t.crm.dohistory.update({...e}).then((()=>{p({title:"成功",message:"状态更新",type:"success"})}))})(e.row)},{reference:j((()=>[x(s,{text:"",bg:"",type:y(e.row.state).type},{default:j((()=>[M(R(y(e.row.state).label),1)])),_:2},1032,["type"])])),_:2},1032,["onConfirm"])])),"slot-reply":j((({scope:e})=>[x(s,{text:"",bg:"",type:"warning",onClick:l=>{return a=e.row,w.value=!0,g.value=a,void h.value++;var a}},{default:j((()=>[M(" 反馈 ")])),_:2},1032,["onClick"])])),_:1},512)])),_:1}),x(i,null,{default:j((()=>[x(u),x(k)])),_:1}),x(Y,{ref_key:"Upsert",ref:c},null,512),x(D,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),title:"反馈列表",fullscreen:!0},{default:j((()=>[(_(),N(he,{orderInfo:l.orderInfo,historyInfo:g.value,key:h.value,style:{height:"80vh"}},null,8,["orderInfo","historyInfo"]))])),_:1},8,["modelValue"])])),_:1},512)}}}),Ie={style:{padding:"10px 10px 0px 20px",display:"flex","flex-wrap":"wrap","row-gap":"10px"}},ke=D("div",{class:"divider"},null,-1),_e={class:"more"},Ye={class:"more_btn"},De={style:{padding:"0 30px"}},xe=g({name:"crm-order"}),je=g({...xe,setup(l){var n;const{dict:t}=o(),{crm:i}=r(),{service:s}=d(),{user:c}=a(),m=$(1!=(null==(n=c.info)?void 0:n.id)),v=$(),b=$(),y=$(),h=$(),g=$(),w=$(0),V=$(),F=E([{label:"待处理",type:"danger",value:0},{label:"处理中",type:"warning",value:1},{label:"已完成",type:"success",value:2}]),O=$({});$({});const S=$({}),A=new Date,B=$(W(A).format("YYYY-MM-DD"));$(!1);const G=e.useUpsert({items:[{type:"tabs",props:{labels:[{label:"基础信息",value:"base"},{label:"其他信息",value:"other"},{label:"富文本信息",value:"text"},{label:"人员信息",value:"personnel"},{label:"财务信息",value:"finance"}]}},{label:"下单者",prop:"uid",span:12,required:!0,value:c.info.id,hidden:()=>1!=c.info.id,component:{name:"el-select",props:{clearable:!0}},group:"base"},{label:"项目订单",span:12,prop:"orderCode",hidden:()=>{var e;return"add"==(null==(e=G.value)?void 0:e.mode)},component:{name:"el-input",props:{disabled:()=>{var e;return"add"!==(null==(e=G.value)?void 0:e.mode)}}},group:"base"},{label:"域名归属我司",prop:"isSelf",span:6,value:0,component:{name:"el-switch",props:{activeValue:1,inactiveValue:0}},group:"base"},{label:"是否备案",prop:"isIcp",span:6,value:0,component:{name:"el-switch",props:{activeValue:1,inactiveValue:0}},group:"base"},()=>{var e;return{label:"域名",prop:"domain",span:24,component:{name:"el-input",props:{type:"textarea",rows:4,disabled:"add"!=(null==(e=G.value)?void 0:e.mode)}},group:"base"}},{label:"新增域名",prop:"newDomain",hidden:()=>{var e;return"add"==(null==(e=G.value)?void 0:e.mode)},component:{name:"slot-newDomain",disabled:()=>{var e;return"update"!==(null==(e=G.value)?void 0:e.mode)}},group:"base"},{label:"客户",prop:"customerId",component:{name:"slot-customerId"},group:"base"},{label:"项目名称",prop:"siteName",required:!0,component:{name:"el-input"},group:"base"},()=>({label:"项目进度",prop:"state",span:12,hidden:()=>{var e;return"add"==(null==(e=G.value)?void 0:e.mode)},component:{name:"el-select",options:F},group:"base"}),{label:"订单类型",prop:"orderType",span:12,required:!0,component:{name:"el-select",options:t.get("orderType")},group:"base"},{label:"主订单到期",prop:"mainEndDate",span:12,hidden:()=>{var e;return"add"==(null==(e=G.value)?void 0:e.mode)},component:{name:"el-input",props:{disabled:!0}},group:"base"},{label:"续费时间",prop:"endDate",span:12,value:W().add(1,"year").format("YYYY-MM-DD"),component:{name:"el-date-picker",props:{type:"date",valueFormat:"YYYY-MM-DD"}},group:"base"},{label:"需求上传",prop:"requirementFiles",component:{name:"cl-upload",props:{type:"file",multiple:!0,showFileList:!0,draggable:!0,rename:!1}},group:"base"},{label:"模板地址",prop:"siteUrl",component:{name:"el-input"},group:"other"},{label:"交单日期",prop:"completeDate",span:12,value:W().add(7,"day").format("YYYY-MM-DD"),component:{name:"el-date-picker",props:{type:"date",valueFormat:"YYYY-MM-DD"}},group:"other"},{label:"联系人",prop:"contactor",span:12,component:{name:"el-input"},group:"other"},{label:"手机",prop:"phone",span:12,component:{name:"el-input"},group:"other"},{label:"公司座机",prop:"tel",span:12,component:{name:"el-input"},group:"other"},{label:"传真",prop:"zipCode",span:12,component:{name:"el-input"},group:"other"},{label:"Email",prop:"email",span:12,component:{name:"el-input"},group:"other"},{label:"QQ",prop:"qq",span:12,component:{name:"el-input"},group:"other"},{label:"地址",prop:"addess",component:{name:"el-input"},group:"other"},{label:"备注",prop:"remark",component:{name:"cl-editor-quill",props:{height:200}},group:"text"},{label:"项目信息",prop:"projectInfo",component:{name:"cl-editor-quill",props:{height:200}},group:"text"},{label:"渠道",prop:"agentId",component:{name:"slot-agentId",options:[],props:{clearable:!0}},group:"personnel"},{label:"客服",prop:"waiterId",span:12,component:{name:"el-select",options:[],props:{clearable:!0}},group:"personnel"},{label:"技术员",prop:"technicianId",span:12,component:{name:"el-select",options:[],props:{clearable:!0}},group:"personnel"},{label:"项目对接人",prop:"siteManagerId",span:12,required:!0,component:{name:"el-select",options:[],props:{clearable:!0}},group:"personnel"},{label:"发票上传",prop:"invoiceImgs",component:{name:"cl-upload",props:{type:"file",multiple:!0,showFileList:!0,draggable:!0,rename:!1}},group:"finance"},{label:"合同上传",prop:"contractFiles",component:{name:"cl-upload",props:{type:"file",multiple:!0,showFileList:!0,draggable:!0,rename:!1}},group:"finance"},{label:"项目总价",prop:"price",span:12,required:!0,component:{name:"el-input",props:{suffixIcon:f}},group:"finance"},{label:"续费价格",prop:"renewal",span:12,required:!0,component:{name:"el-input",props:{suffixIcon:f}},group:"finance"},{label:"返佣",prop:"rebate",span:12,required:!0,value:0,component:{name:"el-input",props:{suffixIcon:f}},group:"finance"}],async onOpen(e){var l,a,o,r,n,t;v.value="",h.value="",b.value="","add"!=(null==(l=G.value)?void 0:l.mode)&&(b.value=e.domain),1==c.info.id&&(null==(a=G.value)||a.setOptions("uid",g.value.map((e=>({label:e.nickName||"",value:e.id||""}))))),"update"==(null==(o=G.value)?void 0:o.mode)&&(await ne(e.customerId),await pe(e.agentId)),null==(r=G.value)||r.setOptions("waiterId",g.value.map((e=>({label:e.nickName||"",value:e.id||""})))),null==(n=G.value)||n.setOptions("technicianId",g.value.map((e=>({label:e.nickName||"",value:e.id||""})))),null==(t=G.value)||t.setOptions("siteManagerId",g.value.map((e=>({label:e.nickName||"",value:e.id||""}))))},onSubmit(e,{next:l}){var a;let o={domain:h.value?h.value:e.domain};1!=(null==(a=c.info)?void 0:a.id)&&(o.uid=c.info.id),(null==e?void 0:e.domain)&&(e.domain=null==e?void 0:e.domain.trim()),l({...e,...o})}}),P=e.useTable({columns:[{type:"selection"},()=>({label:"#",type:"expand",prop:"detail"}),{label:"下单者",prop:"userName",hidden:m},{label:"项目订单",prop:"orderCode"},{label:"域名",prop:"domain",minWidth:150},{label:"网站名称",prop:"siteName",minWidth:200},{label:"项目进度",prop:"state"},{label:"价格",prop:"price"},{label:"续费时间",prop:"endDate"},{label:"创建时间",prop:"createTime",component:{name:"cl-date-text",props:{format:"YYYY-MM-DD"}}},{type:"op",buttons:["slot-subOp"],width:260}]}),K=e.useCrud({service:s.crm.order,async onRefresh(e,{render:l}){const{list:a,pagination:o}=await s.crm.order.page(e);l(a,o),S.value=ae();const r=i.get();g.value=r.value,O.value=Q(g.value),y.value=J(g.value)}},(e=>{var l;e.refresh({departmentId:null==(l=c.info)?void 0:l.departmentId})})),J=e=>e.map((e=>({label:e.nickName||"",value:e.id||""}))),Q=e=>{let l={};return e.forEach((e=>{l[e.id]=e.name})),l},H=e.useAdvSearch({items:[()=>({label:"下单者",prop:"uid",hidden:()=>{var e;return 1!=(null==(e=c.info)?void 0:e.id)},component:{name:"cl-select",props:{clearable:!0,options:[...y.value]}}}),()=>({label:"排序",prop:"orderBy",component:{name:"cl-select",props:{clearable:!0,options:[{label:"最近更新",value:"updateTimeDesc"}]}}}),{label:"订单类型",prop:"orderType",component:{name:"el-select",props:{clearable:!0},options:t.get("orderType").value}},{label:"项目进度",prop:"state",component:{name:"el-select",props:{clearable:!0},options:F}},{label:"到期区间",prop:"month",component:{name:"cl-select",props:{options:[{label:"当月",value:"0"},{label:"未来一个月",value:"1"},{label:"未来二个月",value:"2"},{label:"未来三个月",value:"3"},{label:"未来半年",value:"6"},{label:"未来一年",value:"12"}]}}},{label:"时间",prop:"dateTime",component:{name:"el-date-picker",props:{type:"daterange",startPlaceholder:"开始日期",endPlaceholder:"结束日期",value:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD"}}}]}),X=$(!1),Z=$(!1),ee=$(!1),le=e=>{if(F.length){const l=F.filter((l=>l.value==e));if(l.length)return l[0]}},ae=()=>{let e=[];return t.get("orderType").value.forEach((l=>{e[null==l?void 0:l.value]=null==l?void 0:l.label})),e},oe=$(!1),re=$([]),ne=async e=>{if(e&&""!==e){oe.value=!0;const l=await s.crm.customer.list({keyWord:e});oe.value=!1,re.value=l.map((e=>({label:e.company?e.company+": "+e.customerName:""+e.customerName,value:e.id})))}},te=$([]),pe=async e=>{if(e&&""!==e){oe.value=!0;const l=await s.crm.customer.list({keyWord:e});oe.value=!1,te.value=l.map((e=>({label:e.company?e.company+": "+e.customerName:""+e.customerName,value:e.id})))}},ue=()=>{X.value=!0,V.value={},w.value++};return(e,l)=>{const a=I("cl-refresh-btn"),o=I("cl-add-btn"),r=I("cl-multi-delete-btn"),n=I("cl-search-key"),t=I("cl-adv-btn"),d=I("cl-flex1"),i=I("el-button"),c=I("el-tag"),m=I("el-popconfirm"),f=I("el-popover"),y=I("cl-table"),g=I("cl-row"),F=I("cl-pagination"),$=I("el-input"),E=I("cl-col"),W=I("el-select-v2"),A=I("cl-upsert"),J=I("cl-adv-search"),Q=I("cl-crud"),ae=k("permission");return _(),N(Q,{ref_key:"Crud",ref:K},{default:j((()=>[D("div",Ie,[x(a),x(o),x(r,{style:{"margin-right":"10px"}}),x(n),x(t),x(d),x(i,{type:"info",onClick:ue},{default:j((()=>[M("查看子订单")])),_:1})]),ke,x(g,null,{default:j((()=>[x(y,{ref_key:"Table",ref:P,border:!1},{"column-domain":j((({scope:e})=>{var l,a,o,r,n,t;return[""!==(null==(l=e.row)?void 0:l.domain)?(_(!0),Y(q,{key:0},U(null==(o=null==(a=e.row)?void 0:a.domain)?void 0:o.split("\n"),((e,l)=>(_(),N(c,{key:l,size:"small",effect:"plain"},{default:j((()=>[M(R(e),1)])),_:2},1024)))),128)):C("",!0),""!==(null==(r=e.row)?void 0:r.subDomain)?(_(!0),Y(q,{key:1},U(null==(t=null==(n=e.row)?void 0:n.subDomain)?void 0:t.split("\n"),((e,l)=>(_(),N(c,{key:l,size:"small",effect:"plain"},{default:j((()=>[M(R(e),1)])),_:2},1024)))),128)):C("",!0)]})),"column-state":j((({scope:e})=>{var l,a,o,r;return[2==(null==(l=e.row)?void 0:l.state)?(_(),N(i,{key:0,text:"",bg:"",type:null==(o=le(null==(a=e.row)?void 0:a.state))?void 0:o.type},{default:j((()=>{var l,a;return[M(R(null==(a=le(null==(l=e.row)?void 0:l.state))?void 0:a.label),1)]})),_:2},1032,["type"])):C("",!0),2!=(null==(r=e.row)?void 0:r.state)?(_(),N(m,{key:1,title:"项目进度更新?",onConfirm:l=>(e=>{if(2==e.state)return!1;e.state<2&&e.state++,s.crm.order.update({...e}).then((()=>{p({title:"成功",message:"进度更新",type:"success"})}))})(e.row)},{reference:j((()=>{var l,a;return[x(i,{text:"",bg:"",type:null==(a=le(null==(l=e.row)?void 0:l.state))?void 0:a.type},{default:j((()=>{var l,a;return[M(R(null==(a=le(null==(l=e.row)?void 0:l.state))?void 0:a.label),1)]})),_:2},1032,["type"])]})),_:2},1032,["onConfirm"])):C("",!0)]})),"column-endDate":j((({scope:e})=>[e.row.endDate?(_(),Y("span",{key:0,class:L({textRed:!z(me)(e.row.endDate,B.value)})},R(e.row.endDate),3)):C("",!0)])),"slot-subOp":j((({scope:e})=>[x(i,{text:"",bg:"",type:"primary",onClick:l=>{return a=e.row,void(null==(o=K.value)||o.rowEdit(a));var a,o}},{default:j((()=>[M("编辑")])),_:2},1032,["onClick"]),x(i,{text:"",bg:"",type:"info",onClick:l=>{return a=e.row,ee.value=!0,V.value=a,void w.value++;var a}},{default:j((()=>[M("跟踪")])),_:2},1032,["onClick"]),x(f,{placement:"right",width:80,trigger:"click","popper-class":"dzh_popover"},{reference:j((()=>[x(i,{text:"",bg:"",type:"success"},{default:j((()=>[M("更多")])),_:1})])),default:j((()=>[D("div",_e,[T((_(),Y("div",Ye,[x(i,{text:"",bg:"",type:"warning",onClick:l=>{return a=e.row,X.value=!0,V.value=a,void w.value++;var a}},{default:j((()=>[M("追加")])),_:2},1032,["onClick"])])),[[ae,z(s).crm.order.permission.add]]),T((_(),Y("div",null,[x(i,{text:"",bg:"",type:"danger",onClick:l=>{return a=e.row,Z.value=!0,V.value=a,void w.value++;var a}},{default:j((()=>[M("财务")])),_:2},1032,["onClick"])])),[[ae,z(s).crm.finance.permission.page]])])])),_:2},1024)])),"column-detail":j((({scope:e})=>{var l,a,o,r,n,t;return[D("div",De,[D("p",null,"客户: "+R(null==(l=e.row)?void 0:l.cName),1),D("p",null,"订单类型: "+R(S.value[null==(a=e.row)?void 0:a.orderType]),1),D("p",null,"渠道: "+R(null==(o=e.row)?void 0:o.agentName),1),D("p",null,"客服: "+R(O.value[null==(r=e.row)?void 0:r.waiterId]),1),D("p",null,"技术员: "+R(O.value[null==(n=e.row)?void 0:n.technicianId]),1),D("p",null,"项目对接人: "+R(O.value[null==(t=e.row)?void 0:t.siteManagerId]),1)])]})),_:1},512)])),_:1}),x(g,null,{default:j((()=>[x(d),x(F)])),_:1}),x(A,{ref_key:"Upsert",ref:G},{"slot-newDomain":j((({scope:e})=>[x(g,null,{default:j((()=>[x(E,{span:18},{default:j((()=>[x($,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=e=>v.value=e),placeholder:"不要添加http或https"},null,8,["modelValue"])])),_:1}),x(E,null,{default:j((()=>[x(i,{onClick:l=>(e=>{var l;let a="";a=v.value,e&&(a=v.value+"\n"+e),h.value=a.trim().replace(/^https?:\/\//,"").replace(/\/$/,""),null==(l=G.value)||l.setForm("domain",h.value),v.value="",h.value=""})(e.domain)},{default:j((()=>[M("添加")])),_:2},1032,["onClick"])])),_:2},1024),x(E,null,{default:j((()=>[x(i,{onClick:l=>{return e.domain,null==(a=G.value)||a.setForm("domain",b.value),void(h.value=b.value);var a}},{default:j((()=>[M("重置")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),"slot-customerId":j((({scope:e})=>[x(W,{modelValue:e.customerId,"onUpdate:modelValue":l=>e.customerId=l,filterable:"",remote:"","remote-method":ne,clearable:"",options:re.value,loading:oe.value,placeholder:"请输入名称模糊搜索"},null,8,["modelValue","onUpdate:modelValue","options","loading"])])),"slot-agentId":j((({scope:e})=>[x(W,{modelValue:e.agentId,"onUpdate:modelValue":l=>e.agentId=l,filterable:"",remote:"","remote-method":pe,clearable:"",options:te.value,loading:oe.value,placeholder:"请输入名称模糊搜索"},null,8,["modelValue","onUpdate:modelValue","options","loading"])])),_:1},512),x(J,{ref_key:"AdvSearch",ref:H},null,512),x(z(u),{modelValue:X.value,"onUpdate:modelValue":l[1]||(l[1]=e=>X.value=e),title:"下级订单",direction:"rtl",size:"100%"},{default:j((()=>[(_(),N(de,{orderInfo:V.value,key:w.value},null,8,["orderInfo"]))])),_:1},8,["modelValue"]),x(z(u),{modelValue:Z.value,"onUpdate:modelValue":l[2]||(l[2]=e=>Z.value=e),title:"财务列表",direction:"rtl",size:"80%"},{default:j((()=>[(_(),N(fe,{orderInfo:V.value,key:w.value},null,8,["orderInfo"]))])),_:1},8,["modelValue"]),x(z(u),{modelValue:ee.value,"onUpdate:modelValue":l[3]||(l[3]=e=>ee.value=e),title:"跟踪处理",direction:"rtl",size:"80%"},{default:j((()=>[(_(),N(we,{orderInfo:V.value,key:w.value},null,8,["orderInfo"]))])),_:1},8,["modelValue"])])),_:1},512)}}});export{je as default};
