import{i as e}from"./index.umd.min-ead3793b.js";import"./browser-f4ca2ed3.js";import"./vue-echarts-bffdbdc9.js";import{b as s,a as l}from"./element-plus-e665fdbc.js";import"./store-acbd10e3.js";import"./index-ecdd2562.js";import{u as a}from"./index-1fe6d5c5.js";import{d as t,W as r,o,I as n,J as p,a as i,b as u,N as d,c as m,U as c,F as v,M as f,al as b,ak as y}from"./@vue.runtime-core-6173334e.js";import{r as j,u as k}from"./@vue.reactivity-54707199.js";import{p as h,L as _}from"./@vue.shared-0cc4c744.js";import{_ as w}from"./_plugin-vue_export-helper-1b428a4d.js";import"./axios-bb93cf32.js";import"./vue-21f38777.js";import"./@vue.runtime-dom-532828a1.js";import"./monaco-editor-c28fb00f.js";import"./nprogress-27d9be10.js";import"./lodash-es-fd5b777b.js";import"./vue-router-25454f45.js";import"./@vueuse.core-cb7ad152.js";import"./@vueuse.shared-feb01f08.js";import"./pinia-77f7f468.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-005b47e8.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@element-plus.icons-vue-e9c91902.js";import"./@popperjs.core-b696b006.js";import"./@ctrl.tinycolor-a951068a.js";import"./dayjs-f8876307.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";const x={style:{padding:"0 10px 0px 20px",display:"flex","flex-wrap":"wrap","row-gap":"10px"}},g=i("div",{class:"divider"},null,-1),C=t({name:"addons-types"}),I=t({...C,setup(s){const{service:l}=a(),t=e.useUpsert({items:[{label:"标题",prop:"name",required:!0,component:{name:"el-input"}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}},{label:"排序",prop:"orderNum",value:99,component:{name:"el-input-number",props:{min:0}},required:!0}]}),d=e.useTable({columns:[{type:"selection"},{label:"标题",prop:"name"},{label:"备注",prop:"remark",showOverflowTooltip:!0},{label:"排序",prop:"orderNum"},{type:"op",buttons:["edit","delete"]}]}),m=e.useCrud({service:l.base.sys.addonsType},(e=>{e.refresh()}));return(e,s)=>{const l=r("cl-refresh-btn"),a=r("cl-add-btn"),c=r("cl-multi-delete-btn"),v=r("cl-search-key"),f=r("cl-flex1"),b=r("cl-table"),y=r("cl-row"),j=r("cl-pagination"),k=r("cl-upsert"),h=r("cl-crud");return o(),n(h,{ref_key:"Crud",ref:m},{default:p((()=>[i("div",x,[u(l),u(a),u(c,{style:{"margin-right":"10px"}}),u(v),u(f)]),g,u(y,null,{default:p((()=>[u(b,{ref_key:"Table",ref:d,border:!1},null,512)])),_:1}),u(y,null,{default:p((()=>[u(f),u(j)])),_:1}),u(k,{ref_key:"Upsert",ref:t},null,512)])),_:1},512)}}}),U=e=>(b("data-v-0827c741"),e=e(),y(),e),T={style:{padding:"10px 10px 0px 20px",display:"flex","flex-wrap":"wrap","row-gap":"10px"}},S=U((()=>i("div",{class:"divider"},null,-1))),q={class:"fileter"},z=U((()=>i("div",{class:"filter-title"},[i("span",null,"分类：")],-1))),N={class:"filter-name"},O={class:"table-op"},F=t({name:"base-addons"}),L=w(t({...F,setup(t){const{service:b}=a(),y=j([]),w=j([]),x=e.useUpsert({items:[{label:"标题",prop:"name",required:!0,component:{name:"el-input"}},{label:"插件",prop:"menuId",required:!0,component:{name:"el-select",options:[],props:{onChange:e=>{var s;const l=w.value.find((s=>s.id==e));null==(s=x.value)||s.setForm("name",l.name)}}}},{label:"类别",prop:"typeId",required:!0,component:{name:"el-select",options:[],props:{}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}},{label:"排序",prop:"orderNum",value:99,required:!0,component:{name:"el-input-number",props:{min:0}}}],async onOpen(e){b.base.sys.menu.list({addons:!0}).then((e=>{var s;w.value=e,null==(s=x.value)||s.setOptions("menuId",e.map((e=>({label:e.name||"",value:e.id}))))})),b.base.sys.addonsType.list().then((e=>{var s;null==(s=x.value)||s.setOptions("typeId",e.map((e=>({label:e.name||"",value:e.id}))))}))}}),g=e.useTable({columns:[{type:"selection"},{label:"标题",prop:"name"},{label:"类别",prop:"typeName"},{label:"描述",prop:"remark",showOverflowTooltip:!0},{label:"排序",prop:"orderNum"},{type:"op",buttons:["slot-op"]}]}),C=e.useCrud({service:b.base.sys.addons,async onRefresh(e,{render:s}){const{list:l,pagination:a}=await b.base.sys.addons.page(e);s(l,a),y.value=await b.base.sys.addonsType.list()}},(e=>{e.refresh({typeId:V.value,type:J.value})})),U=j(!1),F=()=>{U.value=!0},L=j(),V=j(),J=j(),K=(e,s)=>{var l;s&&(L.value="hasInstall",V.value=null,J.value=s),e&&(L.value=e,V.value=e,J.value=null),s||e||(L.value=null,V.value=null,J.value=null),null==(l=C.value)||l.refresh({typeId:e,type:s})},B=(e,s)=>{b.base.sys.addons.installUpdateStatus({id:e.menuId,active:s}).then((e=>{var a;null==(a=C.value)||a.refresh(),l.success(s?"安装成功":"卸载成功")})).catch((e=>{l.error(e.message)}))},D=(e,s)=>{b.base.sys.addons.lineUpdateStatus({id:e.menuId,active:s}).then((e=>{var a;null==(a=C.value)||a.refresh(),l.success(s?"上架成功":"下架成功")})).catch((e=>{l.error(e.message)}))};return(e,l)=>{const a=r("cl-refresh-btn"),t=r("cl-add-btn"),j=r("cl-multi-delete-btn"),w=r("cl-search-key"),V=r("cl-flex1"),J=r("el-button"),E=r("cl-row"),G=r("cl-table"),M=r("cl-pagination"),R=r("cl-upsert"),W=r("cl-crud");return o(),n(W,{ref_key:"Crud",ref:C},{default:p((()=>[i("div",T,[u(a),u(t),u(j),u(w,{style:{"margin-left":"10px"}}),u(V),u(J,{type:"success",onClick:F},{default:p((()=>[d("插件类型")])),_:1})]),S,u(E,null,{default:p((()=>[i("div",q,[z,i("div",N,[u(J,{onClick:l[0]||(l[0]=e=>K(null,null)),class:h(["f-btn",{active:!L.value}])},{default:p((()=>[d("全部")])),_:1},8,["class"]),u(J,{class:h(["f-btn",{active:"hasInstall"==L.value}]),onClick:l[1]||(l[1]=e=>K(null,"hasInstall"))},{default:p((()=>[d("已安装")])),_:1},8,["class"]),(o(!0),m(v,null,c(y.value,((e,s)=>(o(),n(J,{class:h(["f-btn",{active:L.value==e.id}]),key:s,onClick:s=>K(e.id)},{default:p((()=>[d(_(e.name),1)])),_:2},1032,["class","onClick"])))),128))])])])),_:1}),u(E,null,{default:p((()=>[u(G,{ref_key:"Table",ref:g,border:!1},{"slot-op":p((({scope:e})=>[i("div",O,[!e.row.isInstall&&k(b).base.sys.addons._permission.installUpdateStatus?(o(),n(J,{key:0,type:"warning",text:"",bg:"",onClick:s=>B(e.row,!0)},{default:p((()=>[d("安装")])),_:2},1032,["onClick"])):f("",!0),e.row.isInstall&&k(b).base.sys.addons._permission.installUpdateStatus?(o(),n(J,{key:1,type:"danger",text:"",bg:"",onClick:s=>B(e.row,!1)},{default:p((()=>[d("卸载")])),_:2},1032,["onClick"])):f("",!0),!e.row.isShow&&k(b).base.sys.addons._permission.lineUpdateStatus?(o(),n(J,{key:2,type:"info",text:"",bg:"",onClick:s=>D(e.row,!0)},{default:p((()=>[d("上架")])),_:2},1032,["onClick"])):f("",!0),e.row.isShow&&k(b).base.sys.addons._permission.lineUpdateStatus?(o(),n(J,{key:3,type:"info",text:"",bg:"",onClick:s=>D(e.row,!1)},{default:p((()=>[d("下架")])),_:2},1032,["onClick"])):f("",!0),k(b).base.sys.addons._permission.update?(o(),n(J,{key:4,type:"primary",text:"",bg:"",onClick:s=>{var l;return null==(l=k(x))?void 0:l.edit(e.row)}},{default:p((()=>[d("编辑")])),_:2},1032,["onClick"])):f("",!0)])])),_:1},512)])),_:1}),u(E,null,{default:p((()=>[u(V),u(M)])),_:1}),u(R,{ref_key:"Upsert",ref:x},null,512),u(k(s),{modelValue:U.value,"onUpdate:modelValue":l[2]||(l[2]=e=>U.value=e),title:"插件类型",direction:"rtl",size:"40%"},{default:p((()=>[u(I)])),_:1},8,["modelValue"])])),_:1},512)}}}),[["__scopeId","data-v-0827c741"]]);export{L as default};
