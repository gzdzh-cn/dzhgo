import{d as e,a}from"./@vue.runtime-dom-532828a1.js";import{_ as s}from"./logo-d7900de4.js";import{u as o}from"./browser-5c66c964.js";import"./vue-echarts-cb4fb6c4.js";import{a as r}from"./element-plus-cc31d756.js";import"./store-acbd10e3.js";import"./index-95085aed.js";import{u as t}from"./index-6dccf6bb.js";import{d as l,e as i,o as p,c as m,W as n,a as u,b as d,J as c,K as v,N as j,al as f,ak as h}from"./@vue.runtime-core-6173334e.js";import{r as g,h as b,u as y}from"./@vue.reactivity-54707199.js";import{_}from"./_plugin-vue_export-helper-1b428a4d.js";import{L as w}from"./@vue.shared-0cc4c744.js";import"./monaco-editor-89e755bd.js";import"./axios-bb93cf32.js";import"./nprogress-27d9be10.js";import"./lodash-es-fd5b777b.js";import"./vue-router-25454f45.js";import"./@vueuse.core-cb7ad152.js";import"./@vueuse.shared-feb01f08.js";import"./pinia-dc6d3ad6.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-005b47e8.js";import"./index.umd.min-b551c2d1.js";import"./vue-21f38777.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@element-plus.icons-vue-2c9f4d7f.js";import"./@popperjs.core-b696b006.js";import"./@ctrl.tinycolor-a951068a.js";import"./dayjs-f8876307.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";const x=["innerHTML"],k=["src"],C=l({name:"undefined"}),I=_(l({...C,emits:["update:modelValue","change"],setup(e,{expose:a,emit:s}){const{service:o}=t(),l=g(""),n=g("");function u(){o.base.open.captcha({height:40,width:150}).then((({captchaId:e,data:a})=>{a.includes(";base64,")?l.value=a:n.value=a,s("update:modelValue",e),s("change",{base64:l,svg:n,captchaId:e})})).catch((e=>{r.error(e.message)}))}return i((()=>{u()})),a({refresh:u}),(e,a)=>(p(),m("div",{class:"captcha",onClick:u},[n.value?(p(),m("div",{key:0,class:"svg",innerHTML:n.value},null,8,x)):(p(),m("img",{key:1,class:"base64",src:l.value,alt:""},null,8,k))]))}}),[["__scopeId","data-v-63c69ae6"]]),V=e=>(f("data-v-890ac70e"),e=e(),h(),e),z={class:"page-login"},K={class:"box"},L={class:"logo"},T=V((()=>u("img",{src:s,alt:"Logo"},null,-1))),U=V((()=>u("p",{class:"desc"},"一款快速开发后台权限管理系统",-1))),H={class:"row"},J=["onKeyup"],M={class:"op"},q=l({name:"login"}),A=_(l({...q,setup(s){const{refs:l,setRefs:i,router:f,service:h}=t(),{user:_,app:x}=o(),k=g(!1),C=b({username:"",password:"",captchaId:"",verifyCode:""});async function V(){if(!C.username)return r.error("用户名不能为空");if(!C.password)return r.error("密码不能为空");if(!C.verifyCode)return r.error("图片验证码不能为空");k.value=!0;try{await h.base.open.login(C).then((e=>{_.setToken(e)})),await Promise.all(x.events.hasToken.map((e=>e()))),f.push("/")}catch(e){l.captcha.refresh(),r.error(e.message)}k.value=!1}return(s,o)=>{const r=n("el-form-item"),t=n("el-button"),l=n("el-form");return p(),m("div",z,[u("div",K,[u("div",L,[T,u("span",null,w(y(x).info.name),1)]),U,d(l,{"label-position":"top",class:"form",disabled:k.value},{default:c((()=>[d(r,{label:"用户名"},{default:c((()=>[v(u("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>C.username=e),placeholder:"请输入用户名",maxlength:"20",autocomplete:"on"},null,512),[[e,C.username]])])),_:1}),d(r,{label:"密码"},{default:c((()=>[v(u("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>C.password=e),type:"password",placeholder:"请输入密码",maxlength:"20",autocomplete:"off"},null,512),[[e,C.password]])])),_:1}),d(r,{label:"验证码"},{default:c((()=>[u("div",H,[v(u("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>C.verifyCode=e),placeholder:"图片验证码",maxlength:"4",onKeyup:a(V,["enter"])},null,40,J),[[e,C.verifyCode]]),d(I,{ref:y(i)("captcha"),modelValue:C.captchaId,"onUpdate:modelValue":o[3]||(o[3]=e=>C.captchaId=e),onChange:o[4]||(o[4]=()=>{C.verifyCode=""})},null,8,["modelValue"])])])),_:1}),u("div",M,[d(t,{round:"",loading:k.value,onClick:V},{default:c((()=>[j("登录")])),_:1},8,["loading"])])])),_:1},8,["disabled"])])])}}}),[["__scopeId","data-v-890ac70e"]]);export{A as default};
